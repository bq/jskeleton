<!DOCTYPE html>

<html>
<head>
  <title>Annotated source code Â· JSKELETON</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <!-- Styles -->
  <link rel="stylesheet" title="penguin-theme" href="/bower_components/penguin-themes/themes/penguin-doc/dist/css/penguin-doc.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" media="all" href="/assets/css/annotated/docco.css" />
</head>
<body>
  <header class="header">

    <div class="wrapper">

        <h1 class="title col-a-12 col-c-5">
            <a href="/"><span class="title__logo"><img src="/assets/svg/jskeleton.svg" alt=""/></span>
                JSKELETON
            </a>
        </h1>

        <nav class="header__nav col-a-12 col-c-7">
            <h1 class="header__nav__title">Menu </h1>
            <ul class="nav__menu">
                

                

                

                

                

                

                
                <li class="nav__menu__item"><a
                        class="header__nav__link "
                        href="/guide/">Guide</a></li>
                

                

                
                <li class="nav__menu__item"><a
                        class="header__nav__link "
                        href="/api-reference/">API reference</a></li>
                

                

                
                <li class="nav__menu__item"><a
                        class="header__nav__link "
                        href="/extensions/">Extensions</a></li>
                

                

                
                <li class="nav__menu__item"><a
                        class="header__nav__link header__nav__link--active"
                        href="/annotated/">Annotated source code</a></li>
                

                
<!--
                <li class="nav__menu__item">
                        <a class="header__nav__link" href="https://github.com/bq/penguin" target="_blank">
                            Annotated source code
                        </a>
                </li>
-->
                <li class="nav__menu__item">
                    <a class="header__nav__link" href="https://github.com/bq/jskeleton" target="_blank">
                <span class="header__nav__icon">
                    <svg viewBox="0 0 16 16">
                        <path fill="#828282"
                              d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                    </svg>
                </span>
                        GitHub
                    </a>
                </li>
            </ul>
        </nav>

    </div>

</header>


    <div id="container">
    <div id="background"></div>

    <ul class="sections">

          <li id="title">
              <div class="annotation">
                  <h1>jskeleton_lite.js</h1>
              </div>
          </li>



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, factory)</span> </span>{
<span class="hljs-pi">    'use strict'</span>;
    <span class="hljs-comment">/*globals require,define */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        define([<span class="hljs-string">'jquery'</span>,
            <span class="hljs-string">'underscore'</span>,
            <span class="hljs-string">'backbone'</span>,
            <span class="hljs-string">'backbone.marionette'</span>
        ], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($, _, Backbone, Marionette)</span> </span>{
            <span class="hljs-keyword">return</span> factory.call(root, root, $, _, Backbone, Marionette);
        });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
        <span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>),
            _ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>),
            Backbone = <span class="hljs-built_in">require</span>(<span class="hljs-string">'backbone'</span>);

        Backbone.$ = $;

        <span class="hljs-keyword">var</span> Marionette = <span class="hljs-built_in">require</span>(<span class="hljs-string">'backbone.marionette'</span>),
            Jskeleton = factory(root, $, _, Backbone, Marionette);

        <span class="hljs-built_in">module</span>.exports = Jskeleton;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (root !== <span class="hljs-literal">undefined</span>) {
        root.Jskeleton = factory.call(root, root, root.$, root._, root.Backbone, root.Marionette);
    }

})(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, $, _, Backbone, Marionette)</span> </span>{
<span class="hljs-pi">    'use strict'</span>;

    <span class="hljs-comment">/* jshint unused: false */</span>


    <span class="hljs-keyword">var</span> Jskeleton = root.Jskeleton || {};

     <span class="hljs-string">'use strict'</span>;
     <span class="hljs-comment">/*globals Marionette, Jskeleton, _ */</span>
     <span class="hljs-comment">/* jshint unused: false */</span>


     Marionette.Renderer.render = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(template, data)</span> </span>{
         data = data || {};</pre></div></div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>data.enviroment; //_app, channel, _view
data.templateHelpers; //Marionette template helpers view
data.serializedData; //Marionette model/collection serializedData
data.context; //View-controller context</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">if</span> (!template &amp;&amp; template !== <span class="hljs-string">''</span>) {
             <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Marionette.Error({
                 name: <span class="hljs-string">'TemplateNotFoundError'</span>,
                 message: <span class="hljs-string">'Cannot render the template since its false, null or undefined.'</span>
             });
         }

         template = <span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'function'</span> ? template(data) : template;

         template = <span class="hljs-keyword">typeof</span> template === <span class="hljs-string">'string'</span> ? template : <span class="hljs-built_in">String</span>(template);

         <span class="hljs-keyword">var</span> compiler = Jskeleton.htmlBars.compiler,
             DOMHelper = Jskeleton.htmlBars.DOMHelper,
             hooks = Jskeleton.htmlBars.hooks,
             render = Jskeleton.htmlBars.render;</pre></div></div>

        </li>


        <li id="section-3">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>template = templateFunc();</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">var</span> templateSpec = compiler.compileSpec(template, {}),
             templatePreCompiled = compiler.template(templateSpec),
             env = {
                 dom: <span class="hljs-keyword">new</span> DOMHelper(),
                 hooks: hooks,
                 helpers: Jskeleton._helpers,
                 enviroment: data.enviroment <span class="hljs-comment">// for helper access to the enviroments</span>
             },
             scope = hooks.createFreshScope();

         hooks.bindSelf(env, scope, data);</pre></div></div>

        </li>


        <li id="section-4">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>template access: context (view-controller context) , templateHelpers and model serialized data</p>

            </div>

            <div class="content"><div class='highlight'><pre>
         <span class="hljs-keyword">var</span> dom = render(templatePreCompiled, env, scope, {</pre></div></div>

        </li>


        <li id="section-5">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>contextualElement: output</p>

            </div>

            <div class="content"><div class='highlight'><pre>         }).fragment;

         <span class="hljs-keyword">return</span> dom;
     };
        <span class="hljs-string">'use strict'</span>;
        <span class="hljs-comment">/*globals Jskeleton */</span>

        Jskeleton._helpers = {};

        Jskeleton.registerHelper = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, helperFunc)</span> </span>{
            Jskeleton._helpers[name] = helperFunc;
        };


        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeArray</span><span class="hljs-params">(env, array)</span> </span>{
            <span class="hljs-keyword">var</span> out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(array.length);

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = array.length; i &lt; l; i++) {
                out[i] = env.hooks.getValue(array[i]);
            }

            <span class="hljs-keyword">return</span> out;
        }

        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeObject</span><span class="hljs-params">(env, object)</span> </span>{
            <span class="hljs-keyword">var</span> out = {};

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> object) {
                out[prop] = env.hooks.getValue(object[prop]);
            }

            <span class="hljs-keyword">return</span> out;
        }

        Jskeleton.htmlBars.hooks.invokeHelper = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(morph, env, scope, visitor, _params, _hash, helper, templates, context)</span> </span>{
            <span class="hljs-keyword">var</span> params = normalizeArray(env, _params);
            <span class="hljs-keyword">var</span> hash = normalizeObject(env, _hash);
            <span class="hljs-keyword">return</span> {
                value: helper.call(context, hash, env, params, templates)
            };
        };
         <span class="hljs-string">'use strict'</span>;
         <span class="hljs-comment">/*globals  Jskeleton, _ */</span>
         <span class="hljs-comment">/* jshint unused: false */</span>

         Jskeleton.registerHelper(<span class="hljs-string">'@component'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params, env)</span> </span>{</pre></div></div>

        </li>


        <li id="section-6">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>env.enviroment._app;
env.enviroment.channel;
env.enviroment._view, view-controller</p>

            </div>

            <div class="content"><div class='highlight'><pre>
             params = params || {};

             <span class="hljs-keyword">var</span> componentName = params.name,
                 ComponentClass,
                 component,
                 viewInstance = env.enviroment._view,
                 componentData;

             <span class="hljs-keyword">if</span> (!componentName) {
                 <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un nombre de clase'</span>);
             }</pre></div></div>

        </li>


        <li id="section-7">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>omit component factory name</p>

            </div>

            <div class="content"><div class='highlight'><pre>             componentData = _.omit(params, <span class="hljs-string">'name'</span>);</pre></div></div>

        </li>


        <li id="section-8">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>inject component dependencies</p>

            </div>

            <div class="content"><div class='highlight'><pre>             componentData = _.extend(componentData, {
                 channel: env.enviroment._channel,
                 _app: env.enviroment._app
             });

             component = Jskeleton.factory.new(componentName, componentData);

             <span class="hljs-keyword">if</span> (!component || <span class="hljs-keyword">typeof</span> component !== <span class="hljs-string">'object'</span>) {
                 <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'No se ha podido crear el componente'</span>);
             }

             viewInstance.addComponent(componentName, component);

             <span class="hljs-keyword">return</span> component.render().$el.get(<span class="hljs-number">0</span>);
         });
    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Jskeleton,_ */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-keyword">var</span> Hook = Jskeleton.Hook = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">this</span>.beforeCallbacks = [];
        <span class="hljs-keyword">this</span>.afterCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };


    Hook.prototype.before = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
        <span class="hljs-keyword">this</span>.beforeCallbacks.push(callback);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.after = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
        <span class="hljs-keyword">this</span>.afterCallbacks.push(callback);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.processBefore = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        _.each(<span class="hljs-keyword">this</span>.beforeCallbacks, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
            callback.apply(self);
        });
        <span class="hljs-keyword">this</span>.beforeCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };

    Hook.prototype.processAfter = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
        _.each(<span class="hljs-keyword">this</span>.afterCallbacks, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback)</span> </span>{
            callback.apply(self);
        });
        <span class="hljs-keyword">this</span>.afterCallbacks = [];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };
    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>
    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-9">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Application object factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> factory = {};</pre></div></div>

        </li>


        <li id="section-10">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Default available factory objects</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.prototypes = {
        Model: Backbone.Model,
        Collection: Backbone.Collection
    };</pre></div></div>

        </li>


        <li id="section-11">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Available singletons objects</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.singletons = {};</pre></div></div>

        </li>


        <li id="section-12">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Adds an object class to the factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.add = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, obj)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.prototypes[key]) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'AlreadyDefinedFactoryObject - '</span> + key);
        }
        <span class="hljs-keyword">this</span>.prototypes[key] = obj;
    };</pre></div></div>

        </li>


        <li id="section-13">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Creates a new object.
Can recieve an object class or a string object factory key.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.new = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, options)</span> </span>{
        options = options || {};

        <span class="hljs-keyword">var</span> FactoryObject;

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'function'</span>) {
            FactoryObject = obj;
        } <span class="hljs-keyword">else</span> {
            FactoryObject = <span class="hljs-keyword">this</span>.prototypes[obj];
        }

        <span class="hljs-keyword">if</span> (!FactoryObject) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'UndefinedFactoryObject - '</span> + obj);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FactoryObject(options);
    };</pre></div></div>

        </li>


        <li id="section-14">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Creates a new singleton object o retrieves the created one</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.singleton = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, options)</span> </span>{
        options = options || {};

        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.singletons[obj]) {
            <span class="hljs-keyword">this</span>.singletons[obj] = <span class="hljs-keyword">this</span>.new(obj, options);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.singletons[obj];
    };</pre></div></div>

        </li>


        <li id="section-15">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Retrieves an Object reference</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.get = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.prototypes[obj]) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'UndefinedFactoryObject - '</span> + obj);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.prototypes[obj];
    };</pre></div></div>

        </li>


        <li id="section-16">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Gets all objects added to the factory</p>

            </div>

            <div class="content"><div class='highlight'><pre>    factory.getAll = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.prototypes;
    };


    Jskeleton.factory = factory;
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Jskeleton, Backbone, _ */</span>

    <span class="hljs-comment">/* jshint unused: false */</span>


    <span class="hljs-keyword">var</span> paramsNames = <span class="hljs-regexp">/:\w(\_|\w|\d)*/g</span>;</pre></div></div>

        </li>


        <li id="section-17">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>optionalParam = /((.<em>?))/g,
namedParam = /((\?)?:\w+/g,
splatParam = /\</em>\w+/;
escapeRegExp = /[-{}[]+?.,\\^$|#\s]/g;</p>

            </div>

        </li>


        <li id="section-18">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="router">Router</h2>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.Router = Backbone.Router.extend({
        routes: {},

        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>, <span class="hljs-string">'route'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> route = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>].length) {
                    route += <span class="hljs-string">':'</span> + <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>].join(<span class="hljs-string">':'</span>);
                }
                <span class="hljs-built_in">console</span>.log(route);
            });
        },

        route: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, options, callback)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-19">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>register route with the jskeleton implementation for view-controller and app-workflow</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (options.viewControllerHandler === <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">var</span> routeRegex,
                    handlerName = options.handlerName &amp;&amp; <span class="hljs-keyword">typeof</span> options.handlerName === <span class="hljs-string">'string'</span> ? options.handlerName : <span class="hljs-keyword">this</span>._getHandlerNameFromRoute(routeString),
                    argsNames = <span class="hljs-keyword">this</span>._getRouteParamsNames(routeString),
                    name = options.name;

                <span class="hljs-keyword">if</span> (!_.isRegExp(routeString)) {
                    routeRegex = <span class="hljs-keyword">this</span>._routeToRegExp(routeString);
                }

                <span class="hljs-keyword">if</span> (!callback) {
                    callback = <span class="hljs-keyword">this</span>[name];
                }

                <span class="hljs-keyword">var</span> router = <span class="hljs-keyword">this</span>;

                Backbone.history.route(routeRegex, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(fragment)</span> </span>{
                    <span class="hljs-keyword">var</span> args = router._extractParametersAsObject(routeRegex, fragment, argsNames);
                    <span class="hljs-keyword">if</span> (router.execute(callback, args, handlerName) !== <span class="hljs-literal">false</span>) {
                        router.trigger.apply(router, [<span class="hljs-string">'route:'</span> + name].concat(args));
                        router.trigger(<span class="hljs-string">'route'</span>, name, args);
                        Backbone.history.trigger(<span class="hljs-string">'route'</span>, router, name, args);
                    }
                });

            } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-20">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>register a route with the original Backbone.Router.route implementation</p>

            </div>

            <div class="content"><div class='highlight'><pre>                Backbone.Router.prototype.route.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>

        </li>


        <li id="section-21">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>method to replace a route string with the specified params</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _replaceRouteString: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, params)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                splatPattern;

            _.each(params, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, key)</span> </span>{
                routeString = routeString.replace(<span class="hljs-regexp">/:(\w)+/</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x)</span> </span>{</pre></div></div>

        </li>


        <li id="section-22">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>remove : character</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    x = x.substr(<span class="hljs-number">1</span>, x.length - <span class="hljs-number">1</span>);
                    <span class="hljs-keyword">return</span> params[x] ? Jskeleton.utils.replaceSpecialChars(<span class="hljs-built_in">String</span>(params[x])) : <span class="hljs-string">''</span>;
                });</pre></div></div>

        </li>


        <li id="section-23">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>find splats</p>

            </div>

            <div class="content"><div class='highlight'><pre>                splatPattern = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"\\*"</span> + key);
                routeString = routeString.replace(splatPattern, value);
            });</pre></div></div>

        </li>


        <li id="section-24">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>replace uncomplete conditionals ex. (:id) and coinditional parenthesis ()</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> routeString.replace(<span class="hljs-regexp">/\(([^\):])*:([^\):])*\)/g</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-regexp">/\(|\)/g</span>, <span class="hljs-string">''</span>);
        },</pre></div></div>

        </li>


        <li id="section-25">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Cast url string to a default camel case name (commonly to call view-controller method)
ex: â/show/details -&gt; onShowDetailsâ</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getHandlerNameFromRoute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> endPosParams = routeString.indexOf(<span class="hljs-string">':'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">':'</span>),
                endPosOptionals = routeString.indexOf(<span class="hljs-string">'(/'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">'(/'</span>),
                endPosSplats = routeString.indexOf(<span class="hljs-string">'*'</span>) === -<span class="hljs-number">1</span> ? routeString.length : routeString.indexOf(<span class="hljs-string">'*'</span>);

            <span class="hljs-keyword">var</span> replacedString = routeString.substr(<span class="hljs-number">0</span>, <span class="hljs-built_in">Math</span>.min(endPosParams, endPosOptionals, endPosSplats)).replace(<span class="hljs-regexp">/\/(\w|\d)?/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(x)</span> </span>{
                    <span class="hljs-keyword">return</span> x.replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">''</span>).toUpperCase();
                }),
                handlerName = <span class="hljs-string">'on'</span> + replacedString.charAt(<span class="hljs-number">0</span>).toUpperCase() + replacedString.slice(<span class="hljs-number">1</span>);

            <span class="hljs-keyword">return</span> handlerName;
        },</pre></div></div>

        </li>


        <li id="section-26">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Execute a route handler with the provided parameters.
Override Backbone.Router.exectue method to provide the
view controller handlerName based on routeString.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        execute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(callback, args, handlerName)</span> </span>{
            <span class="hljs-keyword">if</span> (callback) {
                callback.call(<span class="hljs-keyword">this</span>, args, handlerName);
            }
        },</pre></div></div>

        </li>


        <li id="section-27">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Execute a route handler with the provided parameters.
return parameters as object</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _extractParametersAsObject: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(route, fragment, argsNames)</span> </span>{
            <span class="hljs-keyword">var</span> params = route.exec(fragment).slice(<span class="hljs-number">1</span>),
                paramsObject = {};

            _.each(params, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(param, i)</span> </span>{
                <span class="hljs-keyword">if</span> (i === params.length - <span class="hljs-number">1</span>) {
                    param = param || <span class="hljs-literal">null</span>;
                } <span class="hljs-keyword">else</span> {
                    param = param ? <span class="hljs-built_in">decodeURIComponent</span>(param) : <span class="hljs-literal">null</span>;
                }

                <span class="hljs-keyword">if</span> (argsNames[i] !== <span class="hljs-literal">undefined</span>) {
                    paramsObject[argsNames[i]] = param;
                }
            });

            <span class="hljs-keyword">return</span> paramsObject;
        },</pre></div></div>

        </li>


        <li id="section-28">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Extracts route params names as array.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getRouteParamsNames: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> name = paramsNames.exec(routeString),
                names = [];

            <span class="hljs-keyword">while</span> (name !== <span class="hljs-literal">null</span>) {
                names.push(name[<span class="hljs-number">0</span>].replace(<span class="hljs-string">':'</span>, <span class="hljs-string">''</span>));
                name = paramsNames.exec(routeString);
            }

            <span class="hljs-keyword">return</span> names;
        },</pre></div></div>

        </li>


        <li id="section-29">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Router initialization.
Bypass all anchor links except those with data-bypass attribute
Starts router history. All routes should be already added</p>

            </div>

            <div class="content"><div class='highlight'><pre>        init: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-30">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Trigger the initial route and enable HTML5 History API support, set the
root folder to â/â by default.  Change in app.js.</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Backbone.history.start();</pre></div></div>

        </li>


        <li id="section-31">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>log.debug(ârouter.location.hashâ, window.location.hash.replace(â#/â, â/â));
Backbone.history.navigate(window.location.hash.replace(â#/â, â/â), true);</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },

        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.init();
        }
    }, {</pre></div></div>

        </li>


        <li id="section-32">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Get singleton instance bject</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getSingleton: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">var</span> instance = <span class="hljs-literal">null</span>;

            <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">if</span> (!instance) {
                    instance = <span class="hljs-keyword">new</span> Jskeleton.Router();
                }
                <span class="hljs-keyword">return</span> instance;
            }

            Jskeleton.router = getInstance();
            <span class="hljs-keyword">return</span> Jskeleton.router;
        },</pre></div></div>

        </li>


        <li id="section-33">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Initialize Backbone.history.start</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(app)</span> </span>{
            app.router.init();
        }
    });

    <span class="hljs-string">'use strict'</span>;
    <span class="hljs-comment">/*globals Marionette, Jskeleton, _ */</span>
    <span class="hljs-comment">/* jshint unused: false */</span>

    <span class="hljs-comment">/**
     * Reusable component as a Service
     */</span>
    <span class="hljs-keyword">var</span> Service = Marionette.Object.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(opts)</span> </span>{
            <span class="hljs-keyword">var</span> options = opts || {},</pre></div></div>

        </li>


        <li id="section-34">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Todo serviceOptions ?</p>

            </div>

            <div class="content"><div class='highlight'><pre>                serviceOptions = [<span class="hljs-string">'model'</span>, <span class="hljs-string">'collection'</span>, <span class="hljs-string">'events'</span>];

            _.extend(<span class="hljs-keyword">this</span>, _.pick(options, serviceOptions));

            <span class="hljs-keyword">this</span>.options = _.extend({}, <span class="hljs-keyword">this</span>.options, <span class="hljs-keyword">this</span>.defaults, options);

            <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
                <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
        }

    });

    Jskeleton.Service = Service;

    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-35">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h2 id="baseapplication">BaseApplication</h2>
<p> BaseApplication Class that other <code>Jskeleton.Applications</code> can extend from.
 It contains common application behavior as router/events initialization, application channels set up, common get methodsâ¦</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.BaseApplication = Marionette.Application.extend({</pre></div></div>

        </li>


        <li id="section-36">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Default global webapp channel for communicate with other apps</p>

            </div>

            <div class="content"><div class='highlight'><pre>        globalChannel: <span class="hljs-string">'global'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-37">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>generate application id</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.aid = <span class="hljs-keyword">this</span>.getAppId();

            <span class="hljs-keyword">this</span>.router = Jskeleton.Router.getSingleton();

            Marionette.Application.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        },</pre></div></div>

        </li>


        <li id="section-38">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Call to the specified view-controller method for render a app state</p>

            </div>

            <div class="content"><div class='highlight'><pre>        invokeViewControllerRender: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, args, handlerName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-39">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>var hook = this.getHook(),
Get the view controller instance</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> viewController = routeObject._viewController = <span class="hljs-keyword">this</span>._getViewControllerInstance(routeObject);

            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'onNavigate'</span>, viewController);</pre></div></div>

        </li>


        <li id="section-40">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>hook.processBefore();</p>

            </div>

            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> viewController[handlerName] !== <span class="hljs-string">'function'</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El metodo '</span> + handlerName + <span class="hljs-string">' del view controller no existe'</span>);
            }

            viewController[handlerName].call(viewController, args, <span class="hljs-keyword">this</span>.service);
            <span class="hljs-keyword">this</span>._showControllerView(viewController);</pre></div></div>

        </li>


        <li id="section-41">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>hook.processAfter();</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-42">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Show the controller view instance in the application region</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _showControllerView: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(controllerView)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.mainRegion &amp;&amp; <span class="hljs-keyword">this</span>.mainRegion.currentView !== controllerView) {
                <span class="hljs-keyword">this</span>.mainRegion.show(controllerView);
            } <span class="hljs-keyword">else</span> {
                controllerView.render();
            }
        },</pre></div></div>

        </li>


        <li id="section-43">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Factory method to instance objects from Class references</p>

            </div>

            <div class="content"><div class='highlight'><pre>        factory: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Class, options)</span> </span>{
            options = options || {};
            options.parentApp = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Class(options);
        },</pre></div></div>

        </li>


        <li id="section-44">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Internal method to create an application private channel and set the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChannel: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-45">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>backbone.radio</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.globalChannel = <span class="hljs-keyword">this</span>.globalChannel ? Backbone.Radio.channel(<span class="hljs-keyword">this</span>.globalChannel) : Backbone.Radio.channel(<span class="hljs-string">'global'</span>);
            <span class="hljs-keyword">this</span>.privateChannel = <span class="hljs-keyword">this</span>.privateChannel ? Backbone.Radio.channel(<span class="hljs-keyword">this</span>.privateChannel) : Backbone.Radio.channel(<span class="hljs-keyword">this</span>.aid);
        },</pre></div></div>

        </li>


        <li id="section-46">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Add application routes  to the router and event handlers to the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initRoutes: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>._viewControllers = [];
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.routes) {
                _.each(<span class="hljs-keyword">this</span>.routes, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, routeName)</span> </span>{
                    routeObject = routeObject || {};</pre></div></div>

        </li>


        <li id="section-47">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>get view controller class object (it could be a view controller class asigned to the route or a default view controller if no class is specified)</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    routeObject._ViewController = self._extendViewControllerClass(routeObject);</pre></div></div>

        </li>


        <li id="section-48">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>extend view controller class with d.i</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    routeObject._viewControllerOptions = _.extend({
                        app: self,
                        channel: self.privateChannel,
                        service: self.service,
                        region: self.region
                    }, routeObject.viewControllerOptions);</pre></div></div>

        </li>


        <li id="section-49">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>add the route handler to Jskeleton.Router</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self._addAppRoute(routeName, routeObject);</pre></div></div>

        </li>


        <li id="section-50">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>add the event handler to the app globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self._addAppEventListener(routeName, routeObject);
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-51">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>        _addAppRoute: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

            <span class="hljs-keyword">this</span>.router.route(routeString, {
                viewControllerHandler: <span class="hljs-literal">true</span>,
                triggerEvent: routeObject.triggerEvent,
                handlerName: routeObject.handlerName || <span class="hljs-keyword">this</span>._getViewControllerHandlerName(routeString)
            }, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(args, handlerName)</span> </span>{
                self.invokeViewControllerRender(routeObject, args, handlerName);
            });
        },</pre></div></div>

        </li>


        <li id="section-52">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Add listen to a global event changing the url with the event parameters and calling to the view-controller</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _addAppEventListener: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeObject)</span> </span>{
            <span class="hljs-keyword">if</span> (routeObject.eventListener) {
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    handlerName = routeObject.handlerName || <span class="hljs-keyword">this</span>._getViewControllerHandlerName(routeString);

                <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.globalChannel, routeObject.eventListener, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(args)</span> </span>{
                    <span class="hljs-keyword">if</span> (!routeObject.navigate) {</pre></div></div>

        </li>


        <li id="section-53">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>update the url</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self._navigateTo.call(self, routeString, routeObject, args);
                    }

                    self.invokeViewControllerRender(routeObject, args, handlerName);
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-54">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Update the url with the specified parameters</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _navigateTo: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString, routeOptions, params)</span> </span>{
            <span class="hljs-keyword">var</span> triggerValue = routeOptions.triggerNavigate === <span class="hljs-literal">true</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>,
                processedRoute = <span class="hljs-keyword">this</span>.router._replaceRouteString(routeString, params);

            <span class="hljs-keyword">this</span>.router.navigate(processedRoute, {
                trigger: triggerValue
            });
        },</pre></div></div>

        </li>


        <li id="section-55">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Internal method to retrieve the name of the view-controller method to call before render the view</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getViewControllerHandlerName: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeString)</span> </span>{
            <span class="hljs-keyword">var</span> handlerName = <span class="hljs-keyword">this</span>.routes[routeString].handlerName || <span class="hljs-keyword">this</span>.router._getHandlerNameFromRoute(routeString);

            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.routes[routeString].handlerName) {</pre></div></div>

        </li>


        <li id="section-56">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>set the route handler name to the app route object</p>

            </div>

            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.routes[routeString].handlerName = handlerName;
            }

            <span class="hljs-keyword">return</span> handlerName;
        },</pre></div></div>

        </li>


        <li id="section-57">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Extend view controller class for inyect template dependency</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _extendViewControllerClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{

            <span class="hljs-keyword">var</span> template = options.template,
                ViewControllerClass = options.viewControllerClass || <span class="hljs-keyword">this</span>.getDefaultviewController();

            <span class="hljs-keyword">if</span> (!template) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un template'</span>);
            }

            <span class="hljs-keyword">return</span> ViewControllerClass.extend({
                template: template
            });

        },
        _removeViewController: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject, viewController)</span> </span>{
            <span class="hljs-keyword">if</span> (routeObject._viewController === viewController) {
                routeObject._viewController = <span class="hljs-literal">undefined</span>;
            }
        },</pre></div></div>

        </li>


        <li id="section-58">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Get a view controller instance (if no view controller is specified, a default view controller class is instantiated).
Ensure that donât extist a view-controller and if exist that itâs not destroyed</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getViewControllerInstance: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(routeObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                viewController = routeObject._viewController,
                ViewControllerClass = routeObject._ViewController,
                viewControllerOptions = routeObject._viewControllerOptions || {};

            <span class="hljs-keyword">if</span> (!viewController || viewController.isDestroyed === <span class="hljs-literal">true</span>) {
                viewController = <span class="hljs-keyword">this</span>.factory(ViewControllerClass, viewControllerOptions);
                <span class="hljs-keyword">this</span>.listenTo(viewController, <span class="hljs-string">'destroy'</span>, <span class="hljs-keyword">this</span>._removeViewController.bind(<span class="hljs-keyword">this</span>, routeObject, viewController));
            }

            <span class="hljs-keyword">return</span> viewController;
        },</pre></div></div>

        </li>


        <li id="section-59">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Attach application events to the global channel (triggers and listeners)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">var</span> events = options.events || <span class="hljs-keyword">this</span>.events || {};

            <span class="hljs-keyword">this</span>._proxyTriggerEvents(events.triggers);
            <span class="hljs-keyword">this</span>._proxyListenEvents(events.listen);
        },</pre></div></div>

        </li>


        <li id="section-60">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Attach trigger events:
Propagate internal events (application channel) into the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyTriggerEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(triggerArray)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>

        </li>


        <li id="section-61">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Check if triggers are defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (triggerArray &amp;&amp; <span class="hljs-keyword">typeof</span> triggerArray === <span class="hljs-string">'object'</span>) {
                _.each(triggerArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-62">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Listen to the event in the private channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self.listenTo(self.privateChannel, eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">var</span> args;</pre></div></div>

        </li>


        <li id="section-63">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>if the event type is âallâ, the first argument is the name of the event</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'all'</span>) {
                            eventName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];</pre></div></div>

        </li>


        <li id="section-64">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>casting arguments array-like object to array with excluding the eventName argument</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = [eventName].concat(<span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>));
                        } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-65">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>casting arguments array-like object to array</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
                        }</pre></div></div>

        </li>


        <li id="section-66">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>trigger the event throw the globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self.globalChannel.trigger.apply(self.globalChannel, [eventName].concat(args));
                    });
                });

            }
        },</pre></div></div>

        </li>


        <li id="section-67">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Attach Global events to the private channel:
Propagate external events (global channel) into the private channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _proxyListenEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(listenObject)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">if</span> (listenObject &amp;&amp; <span class="hljs-keyword">typeof</span> listenObject === <span class="hljs-string">'object'</span>) {
                _.each(listenObject, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-68">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Listen to that event in the global channel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                    self.listenTo(self.globalChannel, eventName, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">var</span> args;</pre></div></div>

        </li>


        <li id="section-69">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>if the event is âallâ the first argument is the name of the event</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">if</span> (eventName === <span class="hljs-string">'all'</span>) {
                            eventName = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];</pre></div></div>

        </li>


        <li id="section-70">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>casting arguments array-like object to array with excluding the eventName argument</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = [eventName].concat(<span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>));
                        } <span class="hljs-keyword">else</span> {</pre></div></div>

        </li>


        <li id="section-71">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>casting arguments array-like object to array</p>

            </div>

            <div class="content"><div class='highlight'><pre>                            args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
                        }</pre></div></div>

        </li>


        <li id="section-72">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>trigger the event throw the globalChannel</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        self.privateChannel.trigger.apply(self.privateChannel, [eventName].concat(args));
                    });
                });
            }
        },
        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>._started = <span class="hljs-literal">true</span>;

            <span class="hljs-keyword">this</span>._initCallbacks.run(options, <span class="hljs-keyword">this</span>);</pre></div></div>

        </li>


        <li id="section-73">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Add routes listeners to the Jskeleton.router</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._initRoutes(options);</pre></div></div>

        </li>


        <li id="section-74">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Add app proxy events</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._proxyEvents(options);
        },
        stop: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.stopListening();
        },
        destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.removeRegions();
        },</pre></div></div>

        </li>


        <li id="section-75">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Remove all regions from the application</p>

            </div>

            <div class="content"><div class='highlight'><pre>        removeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-76">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>var self = this;
this._regionManager.each(function(region) {
    self.removeRegion(region);
});</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-77">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Get default application view-controller class if no controller is specified</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getDefaultviewController: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> Jskeleton.ViewController;
        },</pre></div></div>

        </li>


        <li id="section-78">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Get default application layout class if no layoutClass is specified</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getDefaultLayoutClass: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> Marionette.LayoutView;
        },</pre></div></div>

        </li>


        <li id="section-79">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Factory hook method</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getHook: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Jskeleton.Hook();
        },</pre></div></div>

        </li>


        <li id="section-80">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Generate unique app id using underscore uniqueId method</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getAppId: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> _.uniqueId(<span class="hljs-string">'a'</span>);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-81">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <h2 id="application">Application</h2>
<p> Application class is a âcontainerâ where to store your webapp logic and split it into small âpiecesâ and âcomponentsâ.
 It initializes <code>regions, events, routes, channels and child applications</code>.
 It has a global channel to communicate with others apps and a private channel to communicate with itâs components,
 A Jskeleton webapp can contain many Jskeleton.Applications.
 A <code>Jskeleton.Application</code> can define multiple child applications (<code>Jskeleton.ChildApplication</code>).</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.Application = Jskeleton.BaseApplication.extend({</pre></div></div>

        </li>


        <li id="section-82">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Default dom reference (usefull for the first webapp root region)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        defaultEl: <span class="hljs-string">'body'</span>,
        defaultRegion: <span class="hljs-string">'root'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>.rootEl = options.rootEl || <span class="hljs-keyword">this</span>.rootEl || <span class="hljs-keyword">this</span>.defaultEl;

            <span class="hljs-keyword">this</span>._region = options.region || <span class="hljs-keyword">this</span>.defaultRegion;</pre></div></div>

        </li>


        <li id="section-83">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p><code>Jskeleton.BaseApplication</code> constructor</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Jskeleton.BaseApplication.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">this</span>.applications = options.applications || <span class="hljs-keyword">this</span>.applications || {};</pre></div></div>

        </li>


        <li id="section-84">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>private object instances of applications</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._childApps = {};

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;

        },</pre></div></div>

        </li>


        <li id="section-85">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Method to start the application, start the <code>ChildApplications</code> and start listening routes/events</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);</pre></div></div>

        </li>


        <li id="section-86">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>init child apps</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._initChildApplications(options);

            Jskeleton.BaseApplication.prototype.start.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-87">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Start the <code>Jskeleton.Router</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.startRouter();
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
        },</pre></div></div>

        </li>


        <li id="section-88">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Method to explicit start a child app instance</p>

            </div>

            <div class="content"><div class='highlight'><pre>        startChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(childApp, options)</span> </span>{
            childApp.start(options);
        },</pre></div></div>

        </li>


        <li id="section-89">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Method to start listening the <code>Backbone.Router</code> (called by a Main Application)</p>

            </div>

            <div class="content"><div class='highlight'><pre>        startRouter: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.router.start();
        },</pre></div></div>

        </li>


        <li id="section-90">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Private method to initialize the application regions</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-91">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>ensure initial root DOM reference is available</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._ensureEl();

            Marionette.Application.prototype._initializeRegions.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-92">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Create root region on root DOM reference</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._createRootRegion();</pre></div></div>

        </li>


        <li id="section-93">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>Create a layout for the application if a layoutView its defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._createApplicationLayout();
        },</pre></div></div>

        </li>


        <li id="section-94">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Private method to ensure that the main application has a dom reference where create the root webapp region</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _ensureEl: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.$rootEl) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.rootEl) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir una rootEl para la Main App'</span>);
                }
                <span class="hljs-keyword">this</span>.$rootEl = $(<span class="hljs-keyword">this</span>.rootEl);
            }
        },</pre></div></div>

        </li>


        <li id="section-95">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Add the root region to the main application</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _createRootRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{

            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._region <span class="hljs-keyword">instanceof</span> Marionette.Region) {</pre></div></div>

        </li>


        <li id="section-96">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>TODO</p>

            </div>

            <div class="content"><div class='highlight'><pre>            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">var</span> rootRegion = {};

                rootRegion[<span class="hljs-keyword">this</span>._region] = <span class="hljs-keyword">this</span>.rootEl;

                <span class="hljs-keyword">this</span>.addRegions(rootRegion);
            }
        },</pre></div></div>

        </li>


        <li id="section-97">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Create a layout for the Application to have more regions
Adds the layout regions to the application object as properties</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _createApplicationLayout: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-98">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>ensure layout object is defined</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.layout &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.layout === <span class="hljs-string">'object'</span>) {
                <span class="hljs-keyword">this</span>.layoutTemplate = <span class="hljs-keyword">this</span>.layout.template; <span class="hljs-comment">//TODO: lanzar aserciÃ³n</span>
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.layoutTemplate) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Si defines un objeto layout tienes que definir un template'</span>);
                }

                <span class="hljs-keyword">this</span>.layoutClass = <span class="hljs-keyword">this</span>.layout.layoutClass || <span class="hljs-keyword">this</span>.getDefaultLayoutClass(); <span class="hljs-comment">//TODO: mirar si poner layout por defecto ( seria necesario entonces poder poner regiones de forma explicita)</span>
                <span class="hljs-keyword">this</span>.layoutClass = <span class="hljs-keyword">this</span>.layoutClass.extend({
                    template: <span class="hljs-keyword">this</span>.layoutTemplate
                });
                <span class="hljs-keyword">this</span>._layout = <span class="hljs-keyword">this</span>.factory(<span class="hljs-keyword">this</span>.layoutClass, <span class="hljs-keyword">this</span>.layout.options);
                <span class="hljs-keyword">this</span>.root.show(<span class="hljs-keyword">this</span>._layout);

                <span class="hljs-keyword">this</span>._addLayoutRegions();
            }
        },</pre></div></div>

        </li>


        <li id="section-99">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Expose layout regions to the application namespace</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _addLayoutRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._layout.regionManager.length &gt; <span class="hljs-number">0</span>) {
                _.each(<span class="hljs-keyword">this</span>._layout.regionManager._regions, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(region, regionName)</span> </span>{
                    self[regionName] = region;
                });
            }
        },</pre></div></div>

        </li>


        <li id="section-100">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>Iterate over child applications to start each one</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChildApplications: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isChildApp) {
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
                _.each(<span class="hljs-keyword">this</span>.applications, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(value, key)</span> </span>{
                    self._initChildApp(key, value);
                });
                <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'applications:start'</span>);
            }
        },</pre></div></div>

        </li>


        <li id="section-101">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Start child application with itâs dependencies injected</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appName, appOptions)</span> </span>{
            <span class="hljs-keyword">var</span> appClass = appOptions.applicationClass,
                startWithParent = appOptions.startWithParent !== <span class="hljs-literal">undefined</span> ? appOptions.startWithParent : <span class="hljs-literal">true</span>;

            appOptions.region = <span class="hljs-keyword">this</span>._getChildAppRegion(appOptions);

            <span class="hljs-keyword">var</span> instanceOptions = _.omit(appOptions, <span class="hljs-string">'applicationClass'</span>, <span class="hljs-string">'startWithParent'</span>),
                instance = <span class="hljs-keyword">this</span>.factory(appClass, instanceOptions);
            <span class="hljs-keyword">this</span>._childApps[appName] = instance;</pre></div></div>

        </li>


        <li id="section-102">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Start child application</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (startWithParent === <span class="hljs-literal">true</span>) {
                <span class="hljs-keyword">this</span>.startChildApp(instance, instanceOptions.startOptions);
            }
        },</pre></div></div>

        </li>


        <li id="section-103">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Get the region where a child application will be rendered when process a route or an event</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _getChildAppRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appOptions)</span> </span>{
            <span class="hljs-keyword">var</span> region,
                regionName = appOptions.region || <span class="hljs-keyword">this</span>.defaultRegion;</pre></div></div>

        </li>


        <li id="section-104">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>retrieve the region from the application layout</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._layout &amp;&amp; <span class="hljs-keyword">this</span>._layout.regionManager) {
                region = <span class="hljs-keyword">this</span>._layout.regionManager.get(regionName);
            }</pre></div></div>

        </li>


        <li id="section-105">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>retrieve the region from the application region manager</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (!region) {
                region = <span class="hljs-keyword">this</span>._regionManager.get(regionName);
            }</pre></div></div>

        </li>


        <li id="section-106">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>the region must exists</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (!region) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'The region must exists in the Parent application.'</span>);
            }

            <span class="hljs-keyword">return</span> region;
        },</pre></div></div>

        </li>


        <li id="section-107">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Get child app instance by name</p>

            </div>

            <div class="content"><div class='highlight'><pre>        getChildApp: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(appName)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._childApps[appName];
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _, Backbone */</span>

    <span class="hljs-comment">/* jshint unused: false */</span></pre></div></div>

        </li>


        <li id="section-108">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <h2 id="childapplication">ChildApplication</h2>
<p> ChildApplication class is a âcontainerâ where to store your webapp logic and split it into small âpiecesâ and âcomponentsâ.
 It initializes regions, events, routes and channels.
 It cannot contain child applications.</p>

            </div>

            <div class="content"><div class='highlight'><pre>    Jskeleton.ChildApplication = Jskeleton.BaseApplication.extend({</pre></div></div>

        </li>


        <li id="section-109">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Default parent region name where the application will be rendered</p>

            </div>

            <div class="content"><div class='highlight'><pre>        defaultRegion: <span class="hljs-string">'root'</span>,
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};</pre></div></div>

        </li>


        <li id="section-110">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>reference to the parent app</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.parentApp = options.parentApp;

            <span class="hljs-keyword">if</span> (!options.region) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'La child app tiene que tener una region especÃ­fica'</span>);
            }</pre></div></div>

        </li>


        <li id="section-111">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>Add the injected region as root</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.mainRegion = options.region;</pre></div></div>

        </li>


        <li id="section-112">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Jskeleton.BaseApplication constructor</p>

            </div>

            <div class="content"><div class='highlight'><pre>            Jskeleton.BaseApplication.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>

        </li>


        <li id="section-113">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Method to start the application and listening routes/events</p>

            </div>

            <div class="content"><div class='highlight'><pre>        start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'before:start'</span>, options);

            Jskeleton.BaseApplication.prototype.start.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-114">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>this._initAppEventsListeners(options);</p>

            </div>

            <div class="content"><div class='highlight'><pre>
            <span class="hljs-keyword">this</span>.triggerMethod(<span class="hljs-string">'start'</span>, options);
        },</pre></div></div>

        </li>


        <li id="section-115">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Private method to initialize de application regions</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _initializeRegions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>

        </li>


        <li id="section-116">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>ensure initial root region is available</p>

            </div>

            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._ensureMainRegion();

            Marionette.Application.prototype._initializeRegions.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>

        </li>


        <li id="section-117">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>Create a layout for the application if a layoutView its defined
this._createLayoutApp();</p>

            </div>

            <div class="content"><div class='highlight'><pre>        },</pre></div></div>

        </li>


        <li id="section-118">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>Private method to ensure that parent region exists</p>

            </div>

            <div class="content"><div class='highlight'><pre>        _ensureMainRegion: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.mainRegion || <span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.mainRegion.show !== <span class="hljs-string">'function'</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir una region para la Child Application'</span>);
            }
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.View = Marionette.View.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>.channel = options.channel || <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">this</span>._app = options.app;

            Marionette.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.ItemView = Marionette.ItemView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            Jskeleton.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton */</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.LayoutView = Marionette.LayoutView.extend({

        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            options = options || {};

            <span class="hljs-keyword">this</span>._firstRender = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">this</span>._initializeRegions(options);

            Jskeleton.ItemView.call(<span class="hljs-keyword">this</span>, options);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton, _*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.CollectionView = Marionette.CollectionView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{

            <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'render'</span>, <span class="hljs-keyword">this</span>._initialEvents);

            <span class="hljs-keyword">this</span>._initChildViewStorage();

            Jskeleton.View.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

            <span class="hljs-keyword">this</span>.on(<span class="hljs-string">'show'</span>, <span class="hljs-keyword">this</span>._onShowCalled);

            <span class="hljs-keyword">this</span>.initRenderBuffer();
        },</pre></div></div>

        </li>


        <li id="section-119">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>override Marionette method to inject dependencies (as application channel, application reference â¦) into child views</p>

            </div>

            <div class="content"><div class='highlight'><pre>        buildChildView: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(child, ChildViewClass, childViewOptions)</span> </span>{
            <span class="hljs-keyword">var</span> options = _.extend({
                model: child,
                channel: <span class="hljs-keyword">this</span>.channel,
                _app: <span class="hljs-keyword">this</span>._app
            }, childViewOptions);


            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ChildViewClass(options);
        }
    });
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">/*globals Marionette, Jskeleton*/</span>

    <span class="hljs-comment">/* jshint unused: false */</span>

    Jskeleton.CompositeView = Marionette.CompositeView.extend({
        constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
            Jskeleton.CollectionView.apply(<span class="hljs-keyword">this</span>,<span class="hljs-built_in">arguments</span>);
        }
    });

        <span class="hljs-string">'use strict'</span>;

        <span class="hljs-comment">/*globals Jskeleton, Marionette, _ */</span></pre></div></div>

        </li>


        <li id="section-120">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <h2 id="viewcontroller">ViewController</h2>
<p>The view controller object is an hybrid of View/Controller. It is responsible for render an application
state, build up the application context and render the application components.</p>

            </div>

            <div class="content"><div class='highlight'><pre>        Jskeleton.ViewController = Jskeleton.LayoutView.extend({
            constructor: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
                options = options || {};
                <span class="hljs-keyword">this</span>._ensureOptions(options);
                <span class="hljs-keyword">this</span>._app = options.app;
                <span class="hljs-keyword">this</span>.region = options.region;
                <span class="hljs-keyword">this</span>.service = options.service;
                <span class="hljs-keyword">this</span>.context = {};
                <span class="hljs-keyword">this</span>.components = {};
                Jskeleton.LayoutView.prototype.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            },
            _ensureOptions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{
                <span class="hljs-keyword">if</span> (!options.app) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener la referencia a su application'</span>);
                }
                <span class="hljs-keyword">if</span> (!options.channel) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener un canal'</span>);
                }
                <span class="hljs-keyword">if</span> (!options.region) { <span class="hljs-comment">// mirarlo</span>
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'El view-controller necesita tener una region especÃ­fica'</span>);
                }
            },</pre></div></div>

        </li>


        <li id="section-121">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>expose application enviroment, ViewController context and <code>Marionette.templateHelpers</code> to the view-controller template</p>

            </div>

            <div class="content"><div class='highlight'><pre>            mixinTemplateHelpers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(target)</span> </span>{
                target = target || {};
                <span class="hljs-keyword">var</span> templateHelpers = <span class="hljs-keyword">this</span>.getOption(<span class="hljs-string">'templateHelpers'</span>);

                templateHelpers = Marionette._getValue(templateHelpers, <span class="hljs-keyword">this</span>);


                <span class="hljs-keyword">var</span> templateContext = {
                    enviroment: {
                        _app: <span class="hljs-keyword">this</span>._app,
                        _view: <span class="hljs-keyword">this</span>,
                        _channel: <span class="hljs-keyword">this</span>.channel
                    },
                    templateHelpers: templateHelpers,
                    context: <span class="hljs-keyword">this</span>.context, <span class="hljs-comment">// TODO: Mirar bien</span>
                    serializedData: target
                };

                <span class="hljs-keyword">return</span> templateContext;
            },
            addComponent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, instance)</span> </span>{
                <span class="hljs-keyword">this</span>.components[name] = <span class="hljs-keyword">this</span>.components[name] || [];
                <span class="hljs-keyword">this</span>.components[name].push(instance);
            },
            _destroyComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> component;

                _.each(<span class="hljs-keyword">this</span>.components, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(componentArray)</span> </span>{
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; componentArray.length; i++) {
                        component = componentArray[i];

                        <span class="hljs-keyword">if</span> (component &amp;&amp; _.isFunction(component.destroy)) {
                            component.destroy();
                        }

                        <span class="hljs-keyword">delete</span> componentArray[i];
                    }
                });
            },</pre></div></div>

        </li>


        <li id="section-122">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Override Marionette._delegateDOMEvents to add Components listeners</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _delegateDOMEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventsArg)</span> </span>{
                <span class="hljs-keyword">var</span> events = Marionette._getValue(eventsArg || <span class="hljs-keyword">this</span>.events, <span class="hljs-keyword">this</span>),
                    componentEvents = Jskeleton.utils.extractComponentEvents(events);

                events = _.omit(events, _.keys(componentEvents));

                <span class="hljs-keyword">this</span>._componentEvents = componentEvents;


                <span class="hljs-keyword">return</span> Marionette.View.prototype._delegateDOMEvents.call(<span class="hljs-keyword">this</span>, events);
            },</pre></div></div>

        </li>


        <li id="section-123">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>Bind event to the specified component using listenTo method</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _delegateComponentEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component, event, handlerName)</span> </span>{
                <span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">this</span>[handlerName];

                <span class="hljs-keyword">if</span> (!handler || <span class="hljs-keyword">typeof</span> handler !== <span class="hljs-string">'function'</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Tienes que definir un mÃ©todo valido como handler del evento de la vista'</span>);
                }

                <span class="hljs-keyword">if</span> (component &amp;&amp; component.isDestroyed !== <span class="hljs-literal">true</span>) {
                    <span class="hljs-keyword">this</span>.listenTo(component, event, handler);
                }
            },</pre></div></div>

        </li>


        <li id="section-124">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Bind off event to the specified component using off method</p>

            </div>

            <div class="content"><div class='highlight'><pre>            _undelegateComponentEvent: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component, event, handler)</span> </span>{
                <span class="hljs-keyword">this</span>.off(event, handler);
            },
            unbindComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    components = <span class="hljs-keyword">this</span>.components;

                _.each(<span class="hljs-keyword">this</span>._componentEvents, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, eventName)</span> </span>{
                    <span class="hljs-keyword">var</span> componentName = Jskeleton.utils.normalizeComponentName(eventName),
                        eventType = Jskeleton.utils.normailzeEventType(eventName),
                        componentArray = components[componentName];

                    _.each(componentArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component)</span> </span>{

                        self._undelegateComponentEvent(component, eventType, method);

                    });
                });
            },</pre></div></div>

        </li>


        <li id="section-125">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>Attach events to the controller-view components to listenTo those events with <code>@component.ComponentName</code> event notation</p>

            </div>

            <div class="content"><div class='highlight'><pre>            bindComponents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
                    components = <span class="hljs-keyword">this</span>.components;

                _.each(<span class="hljs-keyword">this</span>._componentEvents, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method, eventName)</span> </span>{</pre></div></div>

        </li>


        <li id="section-126">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>Get component name from event hash <code>@component.ComponentName</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">var</span> componentName = Jskeleton.utils.normalizeComponentName(eventName),</pre></div></div>

        </li>


        <li id="section-127">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Get event name from event hash <code>click @component.ComponentName</code></p>

            </div>

            <div class="content"><div class='highlight'><pre>                        eventType = Jskeleton.utils.normailzeEventType(eventName),</pre></div></div>

        </li>


        <li id="section-128">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>Get the component instance by component name</p>

            </div>

            <div class="content"><div class='highlight'><pre>                        componentArray = components[componentName];

                    _.each(componentArray, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(component)</span> </span>{
                        self._delegateComponentEvent(component, eventType, method);
                    });
                });
            },
            render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>._destroyComponents();

                Jskeleton.LayoutView.prototype.render.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);

                <span class="hljs-keyword">this</span>.unbindComponents();
                <span class="hljs-keyword">this</span>.bindComponents();

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
            },
            destroy: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>._destroyComponents();
                <span class="hljs-keyword">return</span> Marionette.LayoutView.prototype.destroy.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
        });



    <span class="hljs-keyword">return</span> Jskeleton;

});</pre></div></div>

        </li>

    </ul>
  </div>


  <footer class="footer">

    <div class="wrapper">

        <div class="footer__col col-c-4">

            <ul class="footer__list">
                <li>JSKELETON</li>
                <li><a class="footer__link" href="mailto:front-end@bq.com">front-end@bq.com</a></li>
            </ul>
        </div>

        <div class="footer__col col-c-4">

            <ul class="footer__list">

                
                <li>
                    <a class="footer__link" href="https://github.com/bq">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                    <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

                        <span class="username">bq</span>
                    </a>
                </li>
                

                
                <li>
                    <a class="footer__link" href="https://twitter.com/bqreaders">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                    <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

                        <span class="username">bqreaders</span>
                    </a>
                </li>
                
            </ul>
        </div>

        <div class="footer__col footer__desc col-c-4">
            <ul class="logo__list">
                <li class="logo__list__item"><a href="https://jquery.com/" title="jquery" target="_blank"><span class="invisible">jquery website, open new window</span><svg enable-background="new 0 0 512 512" height="32px" id="jquery" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><polyline fill="#3558A8" points="0,512 512,512 512,0 0,0 0,512  "/><polyline fill="#010101" opacity="0.102" points="389.001,225 95.001,225 81.001,294 337.001,512 512.001,512 512.001,330    389.001,225  "/><path d="M319.774,228.355l0.299,1.259c0.084,0.362-0.145,0.654-0.514,0.654" fill="#5DA3C2"/><path d="M295.801,226.195c-0.074,0.348-0.164,0.789-0.226,1.081l-2.629,12.306l2.766-12.965L295.801,226.195" fill="#5DA3C2"/><polyline fill="#5DA3C2" points="217.02,234.431 215.568,239.573 217.02,234.433 217.02,234.431  "/><path d="M388.68,219.797l-1.566-6.622c-1.235-4.793-4.735-7.059-12.604-7.059h-33.091   c-0.763,0-1.524,0.344-1.68,1.09l-12.555,59.54c-0.164,0.754-0.211,1.289-0.126,1.66c0.09,0.384,1.561,0.313,2.316,0.313h11.462   c0.767,0,2.16,0.058,2.565-0.105c0.424-0.175,0.611-1.31,0.767-2.062l4.051-20.876l4.949-23.157   c0.161-0.742,0.911-1.351,1.671-1.351l32.779-0.022C388.375,221.146,388.854,220.54,388.68,219.797" fill="#FFFFFF"/><path d="M435.312,195.66c-0.769,0.009-14.538,0-14.538,0c-0.762,0-1.741,0.819-2.165,1.448l-25.519,37.541   c-0.435,0.631-0.927,0.608-1.097-0.134l-1.885-8.228c-0.162-0.746-0.924-1.354-1.695-1.354h-16.401   c-0.755,0-1.208,0.63-1.011,1.366l7.352,25.773c0.213,0.739,0.232,1.943,0.043,2.682l-3.428,13.055   c-0.183,0.74,0.286,0.964,1.06,0.964h16.194c0.76,0,1.547-0.222,1.732-0.964l3.432-13.238c0.188-0.738,0.716-1.742,1.172-2.356   l41.645-55.228c0.469-0.605,0.4-1.331-0.359-1.331L435.312,195.66" fill="#FFFFFF"/><path d="M264.556,206.167h-14.802c-0.754,0-1.527,0.266-1.678,1.013l-4.892,22.891l-4.873,21.919   c-0.156,0.742-0.911,0.691-1.674,0.691h-9.727c-9.624,0-8.513-6.079-6.534-15.192c0.023-0.091,6.172-30.309,6.172-30.309   c0.135-0.745-0.363-1.013-1.117-1.013h-14.103c-0.762,0-1.518,0.268-1.666,1.013l-5.673,30.285   c-2.83,16.375-2.916,30.784,16.074,31.259c0.313,0.012,29.984,0,29.984,0c0.768,0,1.521-0.252,1.685-0.989l6.439-30.371   l6.415-30.497C264.587,206.866,264.815,206.167,264.556,206.167" fill="#FFFFFF"/><path d="M117.126,206.116h-15.869c-0.761,0-1.529,0.181-1.697,0.93l-2.864,12.391   c-0.163,0.732,0.324,1.318,1.092,1.318h15.195c0.768,0,1.529-0.692,1.69-1.431l2.759-12.484   C117.432,206.84,117.652,206.116,117.126,206.116" fill="#FFFFFF"/><path d="M96.759,224.934c-0.755,0-1.53,0.603-1.693,1.348l-2.139,9.45l-4.773,21.824c0,0-2.541,11.604-2.785,12.33   c0,0-2.139,8.376-7.248,8.04c-2.377-0.156-5.094-0.702-5.094-0.702H73.02c-1.427-0.432-1.527,1.051-1.702,1.792l-3.152,13.598   c-0.181,0.743,0.307,1.413,1.061,1.425c0,0,6.833,0.962,11.656,0.962h0.793c11.919,0,18.215-7.008,22.24-26.036l4.717-22.025   l4.424-20.492c0.163-0.746-0.286-1.438-1.048-1.438" fill="#FFFFFF"/><path d="M309.047,232.22c0,0.828-2.613,0.671-2.613,0.671l-20.81-0.152c-0.719,0-0.925-1.008-0.975-1.728   c-0.001-0.025,0.053-0.865,0.113-1.073c1.609-5.581,6.408-8.767,14.016-8.767c8.561,0,10.389,4.244,10.389,8.953 M302.009,206.023   c-26.692,0-33.066,16.5-36.61,32.853c-3.546,16.674-3.242,29.854,24.378,29.854h0.997c10.958,0,24.271,0,24.271,0   c0.748-0.014,1.498-0.698,1.647-1.439l2.715-10.576c0.157-0.75-0.349-0.971-1.103-0.971H293.46c-8.998,0-12.219-2.771-11.904-8.996   c-0.006-0.707,0.805-2.51,1.565-2.51h38.265c1.68-0.01,1.734-0.994,1.734-0.994C327.015,225.663,327.271,206.023,302.009,206.023" fill="#FFFFFF"/><path d="M172.539,240.382l-3.077,10.513c-0.212,0.738-1.08,1.229-1.841,1.229h-15.869   c-12.042,0-14.969-9.307-12.042-23.193c2.94-14.196,8.761-22.98,20.605-23.869c16.193-1.221,19.507,10.216,15.581,23.36   L172.539,240.382 M186.641,251.522c0,0,7.476-18.16,9.174-28.658c2.321-14.045-4.706-34.418-31.875-34.418   c-27.008,0-38.727,19.448-43.213,40.594c-4.467,21.297,1.381,39.839,28.24,39.689l40.994-0.025   c0.755-0.002,1.542-0.613,1.735-1.341l3.458-13.16c0.188-0.743-0.281-1.347-1.048-1.349l-3.301-0.025l-3.302-0.014   c-0.648-0.007-1.022-0.428-0.936-0.986C186.579,251.728,186.592,251.626,186.641,251.522" fill="#FFFFFF"/></g></svg></a></li>
                <li class="logo__list__item"><a href="http://sass-lang.com/" title="Sass" target="_blank"><span class="invisible">sass website, open new window</span><svg enable-background="new 0 0 512 512" height="32px" id="sass" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><polyline fill="#9C57A3" points="-1,513 512,513 512,0 -1,0 -1,513  "/><polyline fill="#010101" opacity="0.102" points="401.785,240.469 135.266,240.469 118.42,261.412 98.193,286.559 264.518,513    512,513 512,353.689 401.785,240.469  "/><path d="M294.802,226.195c-0.076,0.348-0.166,0.789-0.227,1.081l-2.63,12.306l2.766-12.965L294.802,226.195" fill="#5DA3C2"/><polyline fill="#5DA3C2" points="216.02,234.431 214.566,239.573 216.02,234.433 216.02,234.431  "/><path d="M98.037,286.73v-20.848c3.871,3.199,8.071,5.6,12.599,7.199c4.529,1.601,9.1,2.4,13.714,2.4   c2.713,0,5.081-0.259,7.104-0.772c2.021-0.515,3.709-1.225,5.065-2.132c1.359-0.907,2.369-1.976,3.033-3.204   c0.666-1.228,0.997-2.563,0.997-4.006c0-1.857-0.527-3.518-1.585-4.981c-1.057-1.464-2.5-2.818-4.329-4.06   c-1.827-1.244-3.995-2.444-6.501-3.602c-2.508-1.157-5.212-2.335-8.111-3.534c-7.399-3.102-12.914-6.894-16.542-11.379   c-3.628-4.485-5.443-9.899-5.443-16.243c0-4.971,1.003-9.241,3.01-12.812c2.008-3.571,4.743-6.515,8.207-8.828   c3.464-2.314,7.475-4.014,12.032-5.1c4.556-1.085,9.385-1.628,14.484-1.628c5.001,0,9.432,0.296,13.297,0.888   c3.864,0.594,7.424,1.505,10.681,2.732v19.692c-1.586-1.143-3.314-2.15-5.187-3.021c-1.87-0.872-3.799-1.592-5.785-2.163   c-1.985-0.572-3.957-0.993-5.914-1.266c-1.957-0.271-3.821-0.406-5.592-0.406c-2.415,0-4.614,0.243-6.599,0.729   c-1.985,0.485-3.661,1.171-5.025,2.058c-1.364,0.885-2.422,1.945-3.172,3.182c-0.75,1.235-1.125,2.617-1.125,4.146   c0,1.601,0.418,3.033,1.253,4.295c0.836,1.265,2.026,2.462,3.568,3.591c1.543,1.128,3.415,2.239,5.614,3.332   c2.2,1.092,4.685,2.208,7.458,3.354c3.785,1.599,7.185,3.299,10.198,5.1c3.014,1.799,5.6,3.83,7.758,6.095   c2.156,2.266,3.806,4.85,4.948,7.757c1.144,2.907,1.714,6.289,1.714,10.146c0,5.327-1.021,9.799-3.063,13.413   c-2.042,3.614-4.814,6.542-8.313,8.784c-3.5,2.244-7.57,3.854-12.213,4.832c-4.643,0.979-9.542,1.468-14.699,1.468   c-5.3,0-10.339-0.436-15.118-1.308C105.676,289.76,101.536,288.46,98.037,286.73" fill="#FFFFFF"/><path d="M227.37,252.168L217,219.898c-0.771-2.413-1.3-5.292-1.585-8.634h-0.557   c-0.186,2.828-0.764,5.607-1.736,8.335l-10.414,32.568H227.37 M262.939,290.566h-23.698l-6.108-19.198h-35.783l-6.15,19.198h-23.57   l35.162-95.995h25.797L262.939,290.566z" fill="#FFFFFF"/><path d="M270.824,286.73v-20.848c3.872,3.199,8.07,5.6,12.601,7.199c4.528,1.601,9.098,2.4,13.712,2.4   c2.716,0,5.082-0.259,7.104-0.772c2.021-0.515,3.711-1.225,5.067-2.132c1.357-0.907,2.367-1.976,3.03-3.204   c0.666-1.228,0.997-2.563,0.997-4.006c0-1.857-0.528-3.518-1.585-4.981s-2.5-2.818-4.327-4.06   c-1.829-1.244-3.996-2.444-6.503-3.602c-2.508-1.157-5.212-2.335-8.112-3.534c-7.397-3.102-12.911-6.894-16.541-11.379   c-3.628-4.485-5.442-9.899-5.442-16.243c0-4.971,1.005-9.241,3.012-12.812c2.006-3.571,4.74-6.515,8.207-8.828   c3.462-2.314,7.473-4.014,12.031-5.1c4.556-1.085,9.384-1.628,14.483-1.628c5,0,9.432,0.296,13.295,0.888   c3.865,0.594,7.427,1.505,10.684,2.732v19.692c-1.587-1.143-3.314-2.15-5.187-3.021c-1.872-0.872-3.8-1.592-5.786-2.163   c-1.985-0.572-3.955-0.993-5.915-1.266c-1.954-0.271-3.819-0.406-5.592-0.406c-2.413,0-4.612,0.243-6.599,0.729   c-1.985,0.485-3.661,1.171-5.025,2.058c-1.363,0.885-2.42,1.945-3.171,3.182c-0.749,1.235-1.125,2.617-1.125,4.146   c0,1.601,0.419,3.033,1.254,4.295c0.834,1.265,2.024,2.462,3.566,3.591c1.545,1.128,3.416,2.239,5.615,3.332   c2.199,1.092,4.686,2.208,7.457,3.354c3.783,1.599,7.184,3.299,10.199,5.1c3.014,1.799,5.6,3.83,7.757,6.095   c2.156,2.266,3.805,4.85,4.948,7.757c1.143,2.907,1.716,6.289,1.716,10.146c0,5.327-1.021,9.799-3.064,13.413   s-4.814,6.542-8.313,8.784c-3.502,2.244-7.572,3.854-12.214,4.832s-9.542,1.468-14.699,1.468c-5.301,0-10.339-0.436-15.117-1.308   C278.464,289.76,274.325,288.46,270.824,286.73" fill="#FFFFFF"/><path d="M347.62,286.73v-20.848c3.869,3.199,8.07,5.6,12.597,7.199c4.53,1.601,9.102,2.4,13.714,2.4   c2.715,0,5.083-0.259,7.104-0.772c2.022-0.515,3.711-1.225,5.067-2.132c1.355-0.907,2.368-1.976,3.031-3.204   c0.665-1.228,0.997-2.563,0.997-4.006c0-1.857-0.528-3.518-1.585-4.981c-1.058-1.464-2.5-2.818-4.328-4.06   c-1.829-1.244-3.997-2.444-6.505-3.602c-2.507-1.157-5.209-2.335-8.107-3.534c-7.4-3.102-12.915-6.894-16.544-11.379   c-3.627-4.485-5.44-9.899-5.44-16.243c0-4.971,1.003-9.241,3.01-12.812c2.006-3.571,4.741-6.515,8.207-8.828   c3.462-2.314,7.473-4.014,12.031-5.1c4.556-1.085,9.384-1.628,14.483-1.628c5,0,9.432,0.296,13.295,0.888   c3.863,0.594,7.426,1.505,10.682,2.732v19.692c-1.585-1.143-3.313-2.15-5.184-3.021c-1.871-0.872-3.801-1.592-5.785-2.163   c-1.986-0.572-3.959-0.993-5.916-1.266c-1.957-0.271-3.819-0.406-5.591-0.406c-2.414,0-4.614,0.243-6.601,0.729   c-1.984,0.485-3.659,1.171-5.023,2.058c-1.365,0.885-2.422,1.945-3.172,3.182c-0.75,1.235-1.126,2.617-1.126,4.146   c0,1.601,0.419,3.033,1.254,4.295c0.837,1.265,2.026,2.462,3.568,3.591c1.542,1.128,3.413,2.239,5.613,3.332   c2.199,1.092,4.686,2.208,7.456,3.354c3.786,1.599,7.186,3.299,10.199,5.1c3.014,1.799,5.602,3.83,7.758,6.095   c2.157,2.266,3.808,4.85,4.95,7.757c1.141,2.907,1.714,6.289,1.714,10.146c0,5.327-1.021,9.799-3.063,13.413   c-2.043,3.614-4.814,6.542-8.315,8.784c-3.499,2.244-7.571,3.854-12.214,4.832c-4.642,0.979-9.541,1.468-14.698,1.468   c-5.3,0-10.338-0.436-15.116-1.308C355.257,289.76,351.119,288.46,347.62,286.73" fill="#FFFFFF"/></g></svg></a></li>
                <li class="logo__list__item"><a href="http://www.w3.org/TR/html5/" title="HTML5" target="_blank"><span class="invisible">html5 website, open new window</span><svg enable-background="new 0 0 512 512" height="32px" id="html5" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><polyline fill="#E44E25" points="0,512 512,512 512,0 0,0 0,512  "/><path d="M512,364.645c-38.58-39.604-160.309-189.301-160.309-189.301H155.086l17.793,194.729L315.395,512H512   V364.645" opacity="0.1"/><polyline fill="#FFFFFF" points="161.318,110.395 174.658,110.395 174.658,125.194 189.814,125.194 189.814,110.395    203.152,110.395 203.152,153.018 189.814,153.018 189.814,135.851 174.658,135.851 174.658,153.018 161.318,153.018    161.318,110.395  "/><polyline fill="#FFFFFF" points="208.608,110.395 249.834,110.395 249.834,120.458 235.89,120.458 235.89,153.018 222.552,153.018    222.552,120.458 208.608,120.458 208.608,110.395  "/><polyline fill="#FFFFFF" points="255.292,110.395 272.873,110.395 279.57,136.425 286.2,110.395 303.794,110.395 303.794,153.018    292.88,153.018 292.88,120.701 284.647,153.018 274.521,153.018 266.205,120.701 266.205,153.018 255.292,153.018 255.292,110.395     "/><polyline fill="#FFFFFF" points="312.281,110.395 325.617,110.395 325.617,142.363 346.839,142.363 346.839,153.018    312.281,153.018 312.281,110.395  "/><polyline fill="#FFFFFF" points="253.253,290.938 253.118,290.938 165.645,290.938 156.023,185.599 155.086,175.344    253.118,175.344 253.253,175.344 351.186,175.344 350.251,185.599 348.467,204.978 347.681,213.57 347.556,213.57 253.253,213.57    253.118,213.57 197.871,213.57 201.449,252.714 253.118,252.714 253.253,252.714 333.568,252.714 344.118,252.714 343.162,262.979    333.964,363.614 333.375,370.073 253.254,391.755 253.254,391.761 253.072,391.811 172.879,370.073 167.396,310.053    185.508,310.053 206.695,310.053 209.483,340.539 253.082,352.035 253.118,352.026 253.118,352.021 296.779,340.516    301.326,290.938 253.253,290.938  "/></g></svg></a></li>
                <li class="logo__list__item"><a href="http://gruntjs.com/" title="gruntJS" target="_blank"><span class="invisible">gruntjs website, open new window</span><svg enable-background="new 0 0 512 512" height="32px" id="grunt" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><polyline fill="#FBAB18" points="0,512 512,512 512,0 0,0 0,512  "/><polyline fill="#010101" opacity="0.05" points="407,236 137,232 108,267 253,512 512,512 512,361 407,236  "/><path d="M295.802,226.195c-0.075,0.348-0.166,0.789-0.227,1.081l-2.63,12.306l2.767-12.965L295.802,226.195" fill="#333333"/><polyline fill="#333333" points="217.02,234.431 215.568,239.573 217.02,234.433 217.02,234.431  "/><path d="M137.243,250.19v-18.283h36.564v31.726c-6.945,5.198-13.089,8.738-18.434,10.62   c-5.344,1.881-11.678,2.822-19.004,2.822c-9.029,0-16.387-1.557-22.07-4.672c-5.687-3.114-10.095-7.751-13.225-13.912   c-3.131-6.162-4.696-13.229-4.696-21.206c0-8.401,1.71-15.708,5.133-21.919c3.423-6.211,8.433-10.925,15.031-14.141   c5.154-2.487,12.082-3.729,20.786-3.729c8.401,0,14.683,0.789,18.844,2.37c4.163,1.578,7.619,4.031,10.368,7.357   c2.75,3.328,4.815,7.546,6.192,12.654l-23.658,3.427c-0.896-2.43-2.417-4.293-4.563-5.586c-2.146-1.294-4.88-1.941-8.208-1.941   c-4.95,0-8.9,1.7-11.847,5.101c-2.945,3.399-4.419,8.779-4.419,16.138c0,7.82,1.548,13.405,4.647,16.754   c3.096,3.349,7.418,5.023,12.962,5.023c2.622,0,5.128-0.269,7.521-0.806c2.391-0.538,5.128-1.451,8.208-2.74v-5.057H137.243" fill="#333333"/><path d="M186.711,220.078h20.029v9.612c1.938-4.066,3.937-6.863,5.999-8.394c2.062-1.528,4.609-2.293,7.646-2.293   c3.17,0,6.644,0.946,10.418,2.839l-6.67,15.914c-2.544-1.031-4.555-1.546-6.033-1.546c-2.813,0-4.996,1.136-6.554,3.41   c-2.217,3.204-3.327,9.198-3.327,17.979V276h-21.508V220.078" fill="#333333"/><path d="M295.864,276h-20.08v-9.444c-2.979,3.799-5.984,6.5-9.014,8.108c-3.031,1.608-6.759,2.411-11.185,2.411   c-5.88,0-10.495-1.758-13.844-5.277c-3.35-3.517-5.025-8.932-5.025-16.247v-35.473h21.508v30.263c0,3.451,0.646,5.901,1.941,7.352   c1.294,1.452,3.115,2.178,5.469,2.178c2.555,0,4.646-0.968,6.275-2.9c1.631-1.931,2.445-5.402,2.445-10.408v-26.483h21.508V276" fill="#333333"/><path d="M308.77,220.078h20.03v9.461c2.979-3.774,5.992-6.476,9.039-8.099c3.048-1.624,6.767-2.437,11.157-2.437   c5.915,0,10.547,1.759,13.896,5.276c3.351,3.517,5.025,8.95,5.025,16.298V276h-21.508v-30.296c0-3.462-0.648-5.91-1.94-7.342   c-1.296-1.436-3.117-2.151-5.47-2.151c-2.588,0-4.689,0.968-6.301,2.906c-1.615,1.938-2.421,5.411-2.421,10.418V276H308.77V220.078   " fill="#333333"/><path d="M406.633,198.57v21.508h11.828v16.133h-11.828v20.23c0,2.431,0.234,4.039,0.704,4.823   c0.718,1.22,1.979,1.83,3.78,1.83c1.625,0,3.894-0.465,6.805-1.395l1.614,13.779c-5.354,1.063-10.356,1.596-15.005,1.596   c-5.388,0-9.36-0.673-11.914-2.017c-2.555-1.344-4.441-3.391-5.663-6.141c-1.221-2.75-1.832-7.195-1.832-13.333v-19.374h-7.525   v-16.133h7.525v-10.383L406.633,198.57" fill="#333333"/></g></svg></a></li>
            </ul>
        </div>

    </div>

    <p class="footer__copy-left">Made with <span class="invisible">love</span>
        <span class="icon icon-heart">
          <svg viewBox="0 0 24 24">
              <path fill="#cc0000" d="M16.4,4C14.6,4,13,4.9,12,6.3C11,4.9,9.4,4,7.6,4C4.5,4,2,6.5,2,9.6C2,14,12,22,12,22s10-8,10-12.4C22,6.5,19.5,4,16.4,4z"/>
          </svg>
        </span>
        by <a href="http://www.bq.com"><strong>bq</strong></a>
    </p>

</footer>


<!-- jQuery -->
<script src="/bower_components/jquery/dist/jquery.min.js"></script>

<!-- kiUI.js -->
<script src="/bower_components/penguin/lib/js/penguin.min.js"></script>

<!-- Components demo -->
<script src="/assets/js/demo.js"></script>

<script src="/assets/js/toc.js"></script>

<script type="text/javascript">
    $(document).ready(function() {

        // $('#main_content').toc({
        //     showEffect: 'none',
        //     submenuTitle: "Annotated source code.",
        //     aClass: "class__link--index"
        // });

        // $('#aside-menu').toc(
        //     {
        //         listType: 'ul',
        //         title: "",
        //         liClass: "aside-subnav__item",
        //         aClass: "class-link-aside",
        //         showEffect: "none"
        //     }
        //     );

      var title = "Annotated source code";
      var submenu = null;

      var asideClasses = {
        ul: "",
        li: "aside-subnav__item",
        a: "class-link-aside"
      };
      var textClasses = {
        ul: "",
        li: "",
        a: "class__link--index"
      }

      function createLi(html, href, classes){
          var li = document.createElement("li");
          var anchor = document.createElement("a");

          anchor.setAttribute("href", href);
          anchor.innerHTML = html;

          asideUl.className = classes.ul;
          li.className = classes.li;
          anchor.className = classes.a;

          li.appendChild(anchor);

          return li;
      };

      var asideUl = document.createElement("ul");
        $.each(submenu, function(key,value){

            if (typeof value === "string"){
              var li = createLi(key, value, asideClasses)

              asideUl.appendChild(li);
            }else{
              var li = createLi(key, value[0], asideClasses);
              asideUl.appendChild(li);

              var textUl = document.createElement("ul");

              $.each(value[1], function(textKey,textValue){
                  var textLi = createLi(textKey, textValue, textClasses);

                  textUl.appendChild(textLi);
              });
              $(value[0]).after(textUl);
            }
        document.getElementById("active-menu-li").appendChild(asideUl);
        });
    });
</script>





</body>
</html>
